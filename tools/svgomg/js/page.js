!function(){"use strict";const t=new Promise((t=>{function s(){"loading"!==document.readyState&&t()}document.addEventListener("readystatechange",s),s()})),s=document.createRange();function i(t){return s.createContextualFragment(String(t)).children[0]}s.selectNode(document.documentElement);const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function h(t,...s){return s=s.map((t=>String(t).replace(/[&<>"'/]/g,(t=>e[t])))),t.reduce(((t,i,e)=>t+i+(s[e]||"")),"")}function n(t){return new Response(t).text()}function o({removeClass:t=!1}={}){return(s,i="active",e="transition")=>{const h=s.classList.contains(i);if(t){if(!h)return Promise.resolve()}else if(h)return Promise.resolve();const n=new Promise((h=>{const n=t=>{t.target===s&&(s.removeEventListener("transitionend",n),s.classList.remove(e),h())};s.classList.add(e),requestAnimationFrame((()=>{s.addEventListener("transitionend",n),s.classList[t?"remove":"add"](i)}))})),o=new Promise((t=>{setTimeout(t,1e3)}));return Promise.race([n,o])}}const c=o(),a=o({removeClass:!0}),r=(()=>{let t;async function s(s,i){const e=await(t||(t=new Promise(((t,s)=>{const i=indexedDB.open("svgo-keyval",1);i.onerror=()=>{s(i.error)},i.onupgradeneeded=()=>{i.result.createObjectStore("keyval")},i.onsuccess=()=>{t(i.result)}})),t));return new Promise(((t,h)=>{const n=e.transaction("keyval",s);n.oncomplete=()=>t(),n.onerror=()=>h(n.error),i(n.objectStore("keyval"))}))}return{async get(t){let i;return await s("readonly",(s=>{i=s.get(t)})),i.result},set:(t,i)=>s("readwrite",(s=>{s.put(i,t)})),delete:t=>s("readwrite",(s=>{s.delete(t)}))}})();class u{constructor(t){this.t=0,this.i={},this.h=t,this.o=null}release(){this.u(),this.o&&(this.o.terminate(),this.o=null)}requestResponse(t){return new Promise(((s,i)=>{t.id=++this.t,this.i[t.id]=[s,i],this.o||this.l(),this.o.postMessage(t)}))}abort(){0!==Object.keys(this.i).length&&(this.u(),this.o&&this.o.terminate(),this.l())}u(){for(const t of Object.keys(this.i))this.m(t,null,new DOMException("AbortError","AbortError"))}l(){this.o=new Worker(this.h),this.o.onmessage=t=>this.v(t)}v(t){t.data.id?this.m(t.data.id,t.data.result,t.data.error&&new Error(t.data.error)):console.log("Unexpected message",t)}m(t,s,i){const e=this.i[t];e?(delete this.i[t],i?e[1](i):e[0](s)):console.log("No resolver for",{id:t,result:s,error:i})}}const l=new class extends u{constructor(){super("js/gzip-worker.js")}compress(t){return this.requestResponse({data:t})}};class d{constructor(t,s,i){this.text=t,this.p=null,this.h=null,this.width=s,this.height=i}async size({compress:t}){return t?(this.p||(this.p=l.compress(this.text).then((t=>t.byteLength))),this.p):this.text.length}get url(){return this.h||(this.h=URL.createObjectURL(new Blob([this.text],{type:"image/svg+xml"}))),this.h}release(){this.h&&URL.revokeObjectURL(this.h)}}function m(t){return{x:t.pageX,y:t.pageY}}function v(t,s){const i=Math.abs(s.x-t.x),e=Math.abs(s.y-t.y);return Math.hypot(i,e)}function g(t,s){return{x:(t.x+s.x)/2,y:(t.y+s.y)/2}}function p(t){return t.touches?[...t.touches].map((t=>m(t))):[m(t)]}class w{constructor(t,{eventArea:s=t,shouldCaptureFunc:i=()=>!0}={}){this.k=t,this._=i,this.C=0,this.S=0,this.P=1,this.M=0,this.L=[],this.D=t=>{"mousedown"===t.type&&0!==t.button||this._(t.target)&&(t.preventDefault(),this.L=p(t),this.M++,1===this.M&&this.F())},this.T=t=>{t.preventDefault();const s=p(t),i=s.reduce(g),e=this.L.reduce(g),{left:h,top:n}=this.k.getBoundingClientRect();if(this.C+=i.x-e.x,this.S+=i.y-e.y,s[1]){const t=v(s[0],s[1])/v(this.L[0],this.L[1]);this.P*=t,this.C-=(i.x-h)*(t-1),this.S-=(i.y-n)*(t-1)}this.$(),this.L=s},this.j=t=>{t.preventDefault(),this.M--,this.L.pop(),this.M?this.L=p(t):(document.removeEventListener("mousemove",this.T),document.removeEventListener("mouseup",this.j),document.removeEventListener("touchmove",this.T),document.removeEventListener("touchend",this.j))},s.addEventListener("mousedown",this.D),s.addEventListener("touchstart",this.D),s.addEventListener("wheel",(t=>this.R(t)))}reset(){this.C=0,this.S=0,this.P=1,this.$()}R(t){if(!this._(t.target))return;t.preventDefault();const{left:s,top:i}=this.k.getBoundingClientRect();let e=t.deltaY;1===t.deltaMode&&(e*=15),e=Math.max(Math.min(e,60),-60);const h=e/300+1;this.P*h<.05||(this.P*=h,this.C-=(t.pageX-s)*(h-1),this.S-=(t.pageY-i)*(h-1),this.$())}F(){document.addEventListener("mousemove",this.T),document.addEventListener("mouseup",this.j),document.addEventListener("touchmove",this.T),document.addEventListener("touchend",this.j)}$(){this.k.style.transform=`translate3d(${this.C}px, ${this.S}px, 0) scale(${this.P})`}}class f{constructor(){this.container=i('<div class="svg-output"><div class="svg-container"><iframe class="svg-frame" sandbox="allow-scripts" scrolling="no" title="Loaded SVG file"></iframe></div></div>'),this.A=this.container.querySelector(".svg-frame"),this.V=this.container.querySelector(".svg-container"),t.then((()=>{this.O=new w(this.V,{eventArea:this.container})}))}setSvg({text:t,width:s,height:i}){const e=this.B();return this.A.src=`data:image/svg+xml,${encodeURIComponent(t)}`,this.A.style.width=`${s}px`,this.A.style.height=`${i}px`,e}reset(){this.A.src="about:blank",this.O.reset()}B(){return new Promise((t=>{const s=()=>{this.A.removeEventListener("load",s),t()};this.A.addEventListener("load",s)}))}}const y=new class extends u{constructor(){super("js/prism-worker.js")}highlight(t){return this.requestResponse({data:t})}};class k{constructor(){this.container=i('<div class="code-output"><pre><code></code></pre></div>'),this.G=this.container.querySelector("code")}async setSvg({text:t}){this.G.innerHTML=await y.highlight(t)}reset(){this.G.innerHTML=""}}class b{constructor(){this.container=i('<div class="output-switcher"></div>'),this.H={image:new f,code:new k},this.I=null,this.U=Promise.resolve(),this.set("image",{noAnimate:!0})}update(t){return this.I=t,this.H[this.q].setSvg(t)}reset(){this.H[this.q].reset()}set(t,{noAnimate:s=!1}={}){return this.U=this.U.then((async()=>{const i=this.q&&this.H[this.q].container;this.q=t;const e=this.H[this.q].container;if(this.container.append(e),this.I&&await this.update(this.I),s)e.classList.add("active"),i&&i.classList.remove("active");else{const t=[c(e)];i&&t.push(a(i)),await Promise.all(t)}i&&i.remove()})),this.U}}class _{constructor(){this.container=i('<span class="ripple"></span>')}animate(){this.container.classList.remove("animate"),this.container.offsetLeft,this.container.classList.add("animate")}}class x{constructor({title:t,href:s,iconSvg:e,major:h=!1}){this.container=i((s?"<a>":'<button class="unbutton" type="button">')+e+(s?"</a>":"</button>"));const n=["floating-action-button"];s&&(this.container.href=s),t&&this.container.setAttribute("title",t),h&&n.push("major-floating-action-button"),this.container.classList.add(...n),this.W=new _,this.container.append(this.W.container),this.container.addEventListener("click",(()=>this.onClick()))}onClick(){this.W.animate()}}class C{constructor(){this.container=i('<div class="spinner"><div class="spinner-container"><div class="spinner-layer"><div class="circle-clipper left"><div class="circle"></div></div><div class="gap-patch"><div class="circle"></div></div><div class="circle-clipper right"><div class="circle"></div></div></div></div></div>'),this.N=null,this.container.style.display="none",this.container.addEventListener("animationend",(t=>{t.target===this.container&&(this.container.style.display="none")}))}show(t=300){clearTimeout(this.N),this.container.style.display="none",this.container.classList.remove("cooldown"),this.N=setTimeout((()=>{this.container.style.display=""}),t)}hide(){clearTimeout(this.N),this.container.classList.add("cooldown")}}class S extends x{constructor(){super({title:"Скачать",href:"./",iconSvg:'<svg aria-hidden="true" class="icon" viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>',major:!0}),this.K=new C,this.container.append(this.K.container)}setDownload(t,{url:s}){this.container.download=t,this.container.href=s}working(){this.K.show(500)}done(){this.K.hide()}}class P extends x{constructor(){super({title:"Копировать как текст",iconSvg:'<svg aria-hidden="true" class="icon" viewBox="0 0 24 24"><path d="M16 1H4C3 1 2 2 2 3v14h2V3h12V1zm3 4H8C7 5 6 6 6 7v14c0 1 1 2 2 2h11c1 0 2-1 2-2V7c0-1-1-2-2-2zm0 16H8V7h11v14z"/></svg>'}),this.J=null,this.X=document.createElement("pre")}onClick(t){super.onClick(t),this.copyText()}copyText(){if(!this.J)return!1;this.X.textContent=this.J,document.body.append(this.X),getSelection().removeAllRanges();const t=document.createRange();return t.selectNode(this.X),window.getSelection().addRange(t),document.execCommand("copy"),getSelection().removeAllRanges(),this.X.remove(),!0}setCopyText(t){this.J=t}}class M extends x{constructor(){super({title:"Предварительный просмотр на ярком фоне",iconSvg:'<svg aria-hidden="true" class="icon" viewBox="0 0 24 24"><path fill="currentColor" d="M21.143 9.667c-.733-1.392-1.914-3.05-3.617-4.753C14.549 1.936 12.048 1 10.741 1c-.414 0-.708.094-.86.246L8.52 2.606c-1.899-.236-3.42.106-4.294.983-.876.875-1.164 2.159-.792 3.523.492 1.806 2.305 4.049 5.905 5.375.038.323.157.638.405.885.588.588 1.535.586 2.121 0s.588-1.533.002-2.119a1.5 1.5 0 0 0-2.123-.001l-.17.256c-2.031-.765-3.395-1.828-4.232-2.9l3.879-3.875c.496 2.73 6.432 8.676 9.178 9.178l-7.115 7.107c-.234.153-2.798-.316-6.156-3.675-3.393-3.393-3.175-5.271-3.027-5.498L3.96 9.989C3.521 9.63 3.035 8.886 2.819 8.3L.685 10.431C.24 10.877 0 11.495 0 12.251c0 1.634 1.121 3.915 3.713 6.506C6.477 21.521 9.293 23 11.145 23c.648 0 1.18-.195 1.547-.562l8.086-8.078c.91.874-.778 3.538-.778 4.648a2 2 0 0 0 4-.001c0-3.184-1.425-6.81-2.857-9.34zM4.934 4.296c.527-.53 1.471-.791 2.656-.761L4.381 6.741c-.236-.978-.049-1.845.553-2.445zm9.292 4.079-.03-.029C12.904 7.054 10.393 3.99 11.1 3.283c.715-.715 3.488 1.521 5.062 3.096.862.862 2.088 2.247 2.937 3.458-1.717-1.074-3.491-1.469-4.873-1.462z"/></svg>'})}onClick(t){super.onClick(t),this.container.classList.contains("active")?(this.container.classList.remove("active"),document.documentElement.classList.remove("bg-dark")):(this.container.classList.add("active"),document.documentElement.classList.add("bg-dark"))}}function L(t,s){const i=10**s;return Math.floor(Math.round(t*i))/i}function z(t){return t<1024?`${t} bytes`:`${L(t/1024,2)}k`}class D{constructor(){this.container=i('<div class="results"><span class="size"></span> <span class="diff"></span></div>'),this.Y=this.container.querySelector(".size"),this.Z=this.container.querySelector(".diff")}update({size:t,comparisonSize:s}){this.Y.textContent=s?`${z(s)} → ${z(t)}`:z(t),this.Z.classList.remove("decrease","increase"),s?t===s?this.Z.textContent="100%":(this.Z.textContent=`${L(t/s*100,2)}%`,this.Z.classList.add(t>s?"increase":"decrease")):this.Z.textContent=""}}let F=()=>({events:{},emit(t,...s){let i=this.events[t]||[];for(let t=0,e=i.length;t<e;t++)i[t](...s)},on(t,s){return this.events[t]?.push(s)||(this.events[t]=[s]),()=>{this.events[t]=this.events[t]?.filter((t=>s!==t))}}});class T{constructor(t){this.container=i('<div class="material-slider"><div class="track"><div class="track-on"></div><div class="handle"><div class="arrow"></div><div class="val"></div></div></div></div>'),this.tt=t,this.st=this.container.querySelector(".handle"),this.it=this.container.querySelector(".track-on"),this.et=this.container.querySelector(".val"),this.tt.parentNode.insertBefore(this.container,this.tt),this.container.insertBefore(this.tt,this.container.firstChild),this.tt.addEventListener("input",(()=>this.ht())),this.tt.addEventListener("mousedown",(()=>this.nt())),this.tt.addEventListener("touchstart",(()=>this.ot())),this.tt.addEventListener("touchend",(()=>this.ct())),this.rt()}set value(t){this.tt.value=t,this.$()}ot(){this.tt.focus()}ct(){this.tt.blur()}nt(){this.tt.classList.add("active");const t=()=>{requestAnimationFrame((()=>{this.tt.blur()})),this.tt.classList.remove("active"),document.removeEventListener("mouseup",t)};document.addEventListener("mouseup",t)}ht(){this.$()}$(){requestAnimationFrame((()=>this.rt()))}rt(){const{min:t,max:s,value:i}=this.tt,e=(Number(i)-t)/(s-t);this.it.style.width=this.st.style.left=100*e+"%",this.et.textContent=i}}class ${constructor(){this.emitter=F(),this.ut=null,t.then((()=>{this.container=document.querySelector(".settings"),this.lt=[...this.container.querySelectorAll(".plugins input")],this.dt=[...this.container.querySelectorAll(".global input")];const t=this.container.querySelector(".settings-scroller"),s=this.container.querySelector(".setting-reset"),i=this.container.querySelectorAll("input[type=range]");this.vt=new _,s.append(this.vt.container),this.gt=new WeakMap;for(const t of i)this.gt.set(t,new T(t));this.container.addEventListener("input",(t=>this.wt(t))),s.addEventListener("click",(()=>this.ft())),t.addEventListener("mousedown",(t=>{t.target.closest("input[type=range]")||t.preventDefault()}))}))}wt(t){clearTimeout(this.ut),"range"===t.target.type?this.ut=setTimeout((()=>this.emitter.emit("change")),150):this.emitter.emit("change")}ft(){this.vt.animate();const t=this.getSettings();for(const t of this.dt)"checkbox"===t.type?t.checked=t.hasAttribute("checked"):"range"===t.type&&(this.gt.get(t).value=t.getAttribute("value"));for(const t of this.lt)t.checked=t.hasAttribute("checked");this.emitter.emit("reset",t),this.emitter.emit("change")}setSettings(t){for(const s of this.dt)s.name in t&&("checkbox"===s.type?s.checked=t[s.name]:"range"===s.type&&(this.gt.get(s).value=t[s.name]));for(const s of this.lt)s.name in t.plugins&&(s.checked=t.plugins[s.name])}getSettings(){const t=[],s={plugins:{}};for(const i of this.dt)"gzip"!==i.name&&"original"!==i.name&&("checkbox"===i.type?t.push(Number(i.checked)):t.push(`|${i.value}|`)),s[i.name]="checkbox"===i.type?i.checked:i.value;for(const i of this.lt)t.push(Number(i.checked)),s.plugins[i.name]=i.checked;return s.fingerprint=t.join(","),s}}class j{constructor(){this.emitter=F(),this.allowHide=!1,this.K=new C,t.then((()=>{this.container=document.querySelector(".main-menu"),this.yt=this.container.querySelector(".load-file-input"),this.kt=this.container.querySelector(".paste-input"),this.bt=this.container.querySelector(".load-demo"),this._t=this.container.querySelector(".load-file"),this.xt=this.container.querySelector(".menu-input"),this.Ct=this.container.querySelector(".overlay"),this.St=this.container.querySelector(".menu"),document.querySelector(".menu-btn").addEventListener("click",(t=>this.Pt(t))),this.Ct.addEventListener("click",(t=>this.Mt(t))),this._t.addEventListener("click",(t=>this.Lt(t))),this.bt.addEventListener("click",(t=>this.zt(t))),this.yt.addEventListener("change",(()=>this.Dt())),this.kt.addEventListener("input",(()=>this.Ft()))}))}show(){this.container.classList.remove("hidden"),a(this.Ct,"hidden"),a(this.St,"hidden")}hide(){this.allowHide&&(this.stopSpinner(),this.container.classList.add("hidden"),c(this.Ct,"hidden"),c(this.St,"hidden"))}stopSpinner(){this.K.hide()}showFilePicker(){this.yt.click()}setPasteInput(t){this.kt.value=t,this.kt.dispatchEvent(new Event("input"))}Mt(t){t.preventDefault(),this.hide()}Pt(t){t.preventDefault(),this.show()}Ft(){const t=this.kt.value;t.includes("</svg>")&&(this.kt.value="",this.kt.blur(),this.xt.append(this.K.container),this.K.show(),this.emitter.emit("svgDataLoad",{data:t,filename:"image.svg"}))}Lt(t){t.preventDefault(),t.target.blur(),this.showFilePicker()}async Dt(){const t=this.yt.files[0];t&&(this._t.append(this.K.container),this.K.show(),this.emitter.emit("svgDataLoad",{data:await n(t),filename:t.name}))}async zt(t){t.preventDefault(),t.target.blur(),this.bt.append(this.K.container),this.K.show();try{const t=await fetch("test-svgs/car-lite.svg").then((t=>t.text()));this.emitter.emit("svgDataLoad",{data:t,filename:"car-lite.svg"})}catch{this.stopSpinner();const t=new Error("Couldn't fetch demo SVG");this.emitter.emit("error",{error:t})}}}class E{constructor(t,s,e,h){this.container=i('<div class="toast"><div class="toast-content"></div></div>');const n=this.container.querySelector(".toast-content");this.Tt=null,this.$t=null,h?(n.insertAdjacentHTML("afterbegin","<pre><code></code></pre>"),n.querySelector("code").textContent=t):n.textContent=t,this.answer=new Promise((t=>{this.Tt=t}));for(const t of e){const s=document.createElement("button");s.className="unbutton",s.textContent=t,s.type="button",s.addEventListener("click",(()=>{this.Tt(t)})),this.container.append(s)}s&&(this.$t=setTimeout((()=>this.hide()),s))}hide(){return clearTimeout(this.$t),this.Tt(),c(this.container,"hide")}}class R{constructor(){this.container=i('<div class="toasts"></div>')}show(t,{duration:s=0,buttons:i=["dismiss"],isError:e=!1}={}){const h=new E(t,s,i,e);return this.container.append(h.container),h.answer.then((()=>h.hide())).then((()=>{h.container.remove()})),h}}class A{constructor(){this.emitter=F(),this.container=i('<div class="drop-overlay">Drop it!</div>'),this.jt=0,this.Et=null,t.then((()=>{document.addEventListener("dragover",(t=>t.preventDefault())),document.addEventListener("dragenter",(t=>this.Rt(t))),document.addEventListener("dragleave",(()=>this.At())),document.addEventListener("drop",(t=>this.Vt(t)))}))}Rt(t){this.Et!==t.target&&(this.Et=t.target,this.jt++||c(this.container))}At(){this.Et=null,--this.jt||a(this.container)}async Vt(t){t.preventDefault(),this.jt=0,a(this.container);const s=t.dataTransfer.files[0];s&&this.emitter.emit("svgDataLoad",{data:await n(s),filename:s.name})}}class V{constructor(){t.then((()=>{this.container=document.querySelector(".preloader"),this.activated=this.container.classList.contains("active"),this.hide()}))}async hide(){await a(this.container,"active"),this.container.style.display="none"}}class O{constructor(t){this.container=i('<section class="changelog"></section>'),this.Ot=t}async showLogFrom(s){if(s===this.Ot)return;const e=await fetch("changelog.json").then((t=>t.json()));let n=0,o=0;for(const[t,i]of Object.entries(e)){if(i.version===this.Ot)n=t;else if(i.version===s)break;o=t+1}const a=e.slice(n,o).reduce(((t,s)=>t.concat(s.changes)),[]).map((t=>h`<li>${t}</li>`));this.container.append(i("<h1>Updated!</h1>"),i(`<ul>${a.join("")}</ul>`)),await t,c(this.container)}}class B{constructor(s){this.Bt=s,t.then((()=>{this.Gt=document.querySelector(".results-container"),this.Ht=document.querySelector(".results-container-mobile"),this.It=matchMedia("(min-width: 640px)"),this.It.addListener((()=>this.Ut())),this.Ut()}))}Ut(){this.It.matches?this.Gt.append(this.Bt.container):this.Ht.append(this.Bt.container)}}class G{constructor(){this.emitter=F(),this.container=null,t.then((()=>{this.container=document.querySelector(".view-toggler"),this.container.output[0].checked=!0,this.container.addEventListener("change",(()=>{this.emitter.emit("change",{value:this.container.output.value})}))}))}}class H{constructor(t){this.qt=t,this.purge()}purge(){this.Wt=[],this.Nt=[],this.Kt=0}add(t,s){const i=this.Nt[this.Kt];i&&i.release(),this.Wt[this.Kt]=t,this.Nt[this.Kt]=s,this.Kt=(this.Kt+1)%this.qt}match(t){return this.Nt[this.Wt.indexOf(t)]}}class I{constructor(...t){this.Jt=!1,this.Qt=t}activate(){if(!this.Jt)return this.Jt=!0,Promise.all(this.Qt.map((t=>c(t))))}}const U=new class extends u{constructor(){super("js/svgo-worker.js"),this.Xt=Promise.resolve()}async wrapOriginal(t){const{width:s,height:i}=await this.requestResponse({action:"wrapOriginal",data:t});return new d(t,s,i)}process(t,s){return this.abort(),this.Xt=this.Xt.catch((()=>{})).then((async()=>{const{data:i,dimensions:e}=await this.requestResponse({action:"process",settings:s,data:t});return new d(i,e.width,e.height)})),this.Xt}};!function(){let t="mouse";document.body.addEventListener("focus",(s=>{s.target.classList.add("key"===t?"key-focused":"mouse-focused")}),!0),document.body.addEventListener("blur",(t=>{t.target.classList.remove("key-focused","mouse-focused")}),!0),document.body.addEventListener("keydown",(()=>{t="key"}),!0),document.body.addEventListener("mousedown",(()=>{t="mouse"}),!0)}(),new class{constructor(){this.Yt=null,this.Zt=new b,this.ts=new S,this.ss=new P,this.es=new D,this.hs=new $,this.ns=new j,this.os=new R;const s=new M,i=new A,e=new V,h=new O(self.version);this.cs=new B(this.es);const n=new G;this.hs.emitter.on("change",(()=>this.rs())),this.hs.emitter.on("reset",(t=>this.us(t))),this.ns.emitter.on("svgDataLoad",(t=>this.ht(t))),i.emitter.on("svgDataLoad",(t=>this.ht(t))),this.ns.emitter.on("error",(({error:t})=>this.ls(t))),n.emitter.on("change",(t=>this.Zt.set(t.value))),window.addEventListener("keydown",(t=>this.ds(t))),window.addEventListener("paste",(t=>this.vs(t))),window.addEventListener("copy",(t=>this.gs(t))),this.ps=null,this.ws=new H(10),this.fs=0,this.ys=!1,this.ks=!1,"serviceWorker"in navigator&&navigator.serviceWorker.register("sw.js",{scope:"./"}).then((t=>{t.addEventListener("updatefound",(()=>this.bs(t)))})),r.get("last-seen-version").then((t=>{t&&h.showLogFrom(t),r.set("last-seen-version",self.version)})),t.then((()=>{const t=document.querySelector(".app-output"),n=t.querySelector(".action-button-container"),o=t.querySelector(".minor-action-container"),c=t.querySelector(".toolbar"),a=t.querySelector(".output"),r=t.querySelector(".menu-extra");this.Yt=new I(c,n,this.Zt.container,this.hs.container),o.append(s.container,this.ss.container),n.append(this.ts.container),a.append(this.Zt.container),t.append(this.os.container,i.container),r.append(h.container),this._s(),e.activated&&this.os.show("Готово сейчас!",{duration:3e3})}))}ds(t){"o"===t.key&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),this.ns.showFilePicker()),"Escape"===t.key&&this.ns.hide()}vs(t){const s=t.clipboardData.getData("text");s.includes("</svg>")?(this.ns.setPasteInput(s),t.preventDefault()):this.os.show("Вставленное значение не является SVG",{duration:2e3})}gs(t){window.getSelection().isCollapsed&&(this.os.show(this.ss.copyText()?"Копирование успешно":"Нечего копировать",{duration:2e3}),t.preventDefault())}bs(t){const s=t.installing;t.installing.addEventListener("statechange",(async()=>{if(!this.ks)if("activated"!==s.state||navigator.serviceWorker.controller){if("activated"===s.state&&navigator.serviceWorker.controller){if(!this.ys)return this.ks=!0,void location.reload();const t=this.os.show("Доступно обновление",{buttons:["reload","dismiss"]});"reload"===await t.answer&&(this.ks=!0,location.reload())}}else this.os.show("Готов к работе офлайн",{duration:5e3})}))}rs(){const t=this.hs.getSettings();this.xs(t),this.Cs(t)}async us(t){const s=this.os.show("Сброс настроек",{buttons:["undo","dismiss"],duration:5e3});"undo"===await s.answer&&(this.hs.setSettings(t),this.rs())}async ht({data:t,filename:s}){const i=this.hs.getSettings();this.ys=!0;try{this.ps=await U.wrapOriginal(t),this.Ss=s}catch(t){return this.ns.stopSpinner(),void this.ls(new Error(`Load failed: ${t.message}`))}this.ws.purge(),this.Cs(i),this.Zt.reset(),this.Yt.activate(),this.ns.allowHide=!0,this.ns.hide()}ls(t){this.os.show(t.message,{isError:!0}),console.error(t)}async _s(){const t=await r.get("settings");t&&this.hs.setSettings(t)}xs(t){const{original:s,...i}=t;r.set("settings",i)}async Cs(t){const s=this.fs=Math.random();if(await U.abort(),s!==this.fs)return;if(t.original)return void this.Ps(this.ps,{compress:t.gzip});const i=this.ws.match(t.fingerprint);if(i)this.Ps(i,{compareToFile:this.ps,compress:t.gzip});else{this.ts.working();try{const s=await U.process(this.ps.text,t);this.Ps(s,{compareToFile:this.ps,compress:t.gzip}),this.ws.add(t.fingerprint,s)}catch(t){if("AbortError"===t.name)return;t.message=`Minifying error: ${t.message}`,this.ls(t)}finally{this.ts.done()}}}async Ps(t,{compareToFile:s,compress:i}){this.Zt.update(t),this.ts.setDownload(this.Ss,t),this.ss.setCopyText(t.text),this.es.update({comparisonSize:s&&await s.size({compress:i}),size:await t.size({compress:i})})}}}();
//# sourceMappingURL=page.js.map
